import{_ as a,H as o,o as n,c as r,C as s,a as e,J as l,V as p}from"./chunks/framework.d97f05f3.js";const b=JSON.parse('{"title":"@axios-plugin/retry","description":"","frontmatter":{},"headers":[],"relativePath":"plugin/retry.md","filePath":"plugin/retry.md","lastUpdated":1685419014000}'),c={name:"plugin/retry.md"},i={id:"axios-plugin-retry",tabindex:"-1"},d=s("a",{class:"header-anchor",href:"#axios-plugin-retry","aria-label":'Permalink to "@axios-plugin/retry <Badge type="tip" text="^0.0.5" />"'},"​",-1),y=p(`<p>拦截失败的请求并在可能的情况下进行重试</p><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yarn</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@axios-plugin/retry</span></span></code></pre></div><h2 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">RetryPlugin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@axios-plugin/retry</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">axiosInstance </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">pluginify</span><span style="color:#A6ACCD;">(axios)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RetryPlugin</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">retries</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">generate</span><span style="color:#A6ACCD;">()</span></span></code></pre></div><p>参数可选，默认情况下会重试三次</p><h2 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-label="Permalink to &quot;参数&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RetryPlugin</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RetryPlugin</span><span style="color:#A6ACCD;">(config)</span></span></code></pre></div><p>该 Plugin 是对 <a href="https://github.com/softonic/axios-retry" target="_blank" rel="noreferrer">axios-retry</a> 的封装，所以参数和 axios-retry 保持一致。</p><table><thead><tr><th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>retries</td><td><code>Number</code></td><td><code>3</code></td><td>The number of times to retry before failing. 1 = One retry after first failure</td></tr><tr><td>retryCondition</td><td><code>Function</code></td><td><code>isNetworkOrIdempotentRequestError</code></td><td>A callback to further control if a request should be retried. By default, it retries if it is a network error or a 5xx error on an idempotent request (GET, HEAD, OPTIONS, PUT or DELETE).</td></tr><tr><td>shouldResetTimeout</td><td><code>Boolean</code></td><td>false</td><td>Defines if the timeout should be reset between retries</td></tr><tr><td>retryDelay</td><td><code>Function</code></td><td><code>function noDelay() { return 0; }</code></td><td>A callback to further control the delay in milliseconds between retried requests. By default there is no delay between retries. Another option is exponentialDelay (<a href="https://developers.google.com/analytics/devguides/reporting/core/v3/errors#backoff" target="_blank" rel="noreferrer">Exponential Backoff</a>). The function is passed <code>retryCount</code> and <code>error</code>.</td></tr><tr><td>onRetry</td><td><code>Function</code></td><td><code>function onRetry(retryCount, error, requestConfig) { return; }</code></td><td>A callback to notify when a retry is about to occur. Useful for tracing. By default nothing will occur. The function is passed <code>retryCount</code>, <code>error</code>, and <code>requestConfig</code>.</td></tr></tbody></table><h2 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-label="Permalink to &quot;注意&quot;">​</a></h2><p>在使用 TimeoutPlugin 时，首先需要使用 pluginify 将 <code>axios</code>变成基于插件的请求库. pluginify 内置在 <a href="https://www.npmjs.com/package/@axios-plugin/core" target="_blank" rel="noreferrer">@axios-plugin/core</a> 中.</p>`,12);function u(h,C,A,D,f,g){const t=o("Badge");return n(),r("div",null,[s("h1",i,[e("@axios-plugin/retry "),l(t,{type:"tip",text:"^0.0.5"}),e(),d]),y])}const m=a(c,[["render",u]]);export{b as __pageData,m as default};
